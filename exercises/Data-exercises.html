<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Data exploration exercises | R for Bioinformatics</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.1.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    

        
    
    
    <link rel="next" href="../bio1/index.html" />
    
    
    <link rel="prev" href="../exercises/index.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="5.1" data-basepath=".." data-revision="Mon Jul 06 2015 17:51:11 GMT-0400 (EDT)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="section1/index.html">
            
                
                    <a href="../section1/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Overview of R
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="section2/index.html">
            
                
                    <a href="../section2/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Getting Started with R
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="section2/Installation.html">
            
                
                    <a href="../section2/Installation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Installation
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="section2/InteractingWithR.html">
            
                
                    <a href="../section2/InteractingWithR.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Interacting with the R command line
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="section3/index.html">
            
                
                    <a href="../section3/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Data Types
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="section3/vectors.html">
            
                
                    <a href="../section3/vectors.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Vectors
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="graphics/index.html">
            
                
                    <a href="../graphics/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Graphics
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="graphics/ggplot2.html">
            
                
                    <a href="../graphics/ggplot2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        ggplot2
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="exercises/index.html">
            
                
                    <a href="../exercises/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Exercises and Workflows
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="5.1" data-path="exercises/Data-exercises.html">
            
                
                    <a href="../exercises/Data-exercises.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Data exploration exercises
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="bio1/index.html">
            
                
                    <a href="../bio1/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Biological Applications
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="bio1/FASTQ.html">
            
                
                    <a href="../bio1/FASTQ.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Working with FASTQ files
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="GLOSSARY.html">
            
                
                    <a href="../GLOSSARY.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Glossary
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <a href="../GLOSSARY.html" class="btn pull-left" aria-label="Glossary"><i class="fa fa-sort-alpha-asc"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >R for Bioinformatics</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="some-r-data-manipulation-and-plotting-exercises">Some R data manipulation and plotting exercises</h1>
<p>We are going to use a few small datasets to practice our R skills and see what we can learn about the datasets themselves.  These exercises are meant to let you explore and I do not provide answers for all exercises.  You can discuss with your colleagues and with instructors.  Not all exercises have only one best answer.</p>
<h2 id="iris-data">Iris data</h2>
<p>The <em>Iris</em> data represent the famous (Fisher&apos;s or Anderson&apos;s) iris data set gives the
measurements in centimeters of the variables sepal length and
width and petal length and width, respectively, for 50 flowers
from each of 3 species of iris.  The species are <em>Iris setosa</em>,
<em>versicolor</em>, and <em>virginica</em>.</p>
<p>To get started, we can load the data using:</p>
<pre><code class="lang-r">data(iris)
</code></pre>
<p>1. Use your R skills to learn a little about the size and structure of the iris data.  Consider using <code>head</code>,<code>tail</code>,<code>dim</code>,<code>nrow</code>,<code>class</code>.</p>
<p>2. Get some summary statistics for the dataset.  Consider tools like <code>summary</code>, <code>mean</code>, <code>median</code>, <code>sd</code>, <code>IQR</code>. </p>
<p>3. Use some plots to investigate the relationships between the variables.</p>
<p>4. Quantify the relationships between the quantitative variables.</p>
<p>5. Bonus: Use the randomForest package to predict the flower species based on the data.</p>
<h2 id="ensembl-genes-using-biomart">Ensembl Genes using biomaRt</h2>
<h3 id="background">Background</h3>
<p>In recent years a wealth of biological data has become available in public
data repositories. Easy access to these valuable data resources and firm
integration with data analysis is needed for comprehensive bioinformatics
data analysis. The biomaRt package, provides an interface to a growing
collection of databases implementing the BioMart software suite (http://
www.biomart.org). The package enables retrieval of large amounts of data
in a uniform way without the need to know the underlying database schemas
or write complex SQL queries. Examples of BioMart databases are Ensembl,
Uniprot and HapMap. These major databases give biomaRt users direct
access to a diverse set of data and enable a wide range of powerful online
queries from R.</p>
<p>In this exercise, we are going to use the <a href="%60biocurl(%27biomaRt%27">biomaRt Bioconductor package</a>`) to get a 
dataset with biologically-related data to play with using the dplyr and ggplot2 
packages.</p>
<h3 id="getting-started">Getting started</h3>
<p>The biomaRt package is a Bioconductor package, so we need to install it before we can use it.</p>
<pre><code class="lang-r"><span class="hljs-keyword">source</span>(<span class="hljs-string">&apos;http://bioconductor.org/biocLite.R&apos;</span>)
biocLite(<span class="hljs-string">&apos;biomaRt&apos;</span>)
</code></pre>
<p>Before we can use the package, we need to actually load it into our R session.</p>
<pre><code class="lang-r"><span class="hljs-keyword">library</span>(biomaRt)
</code></pre>
<h3 id="connecting-to-a-biomart">Connecting to a biomaRt</h3>
<p>The next step is to connect to a Biomart database.  While this looks a little magical, the biomaRt vignette shows examples and the help pages can be used to get details on how to do this.  In this case, I&apos;ll simply supply the code for you.</p>
<pre><code class="lang-r">ensembl = useMart(<span class="hljs-string">&quot;ensembl&quot;</span>,dataset=<span class="hljs-string">&quot;hsapiens_gene_ensembl&quot;</span>)
</code></pre>
<h3 id="executing-the-biomart-query">Executing the Biomart Query</h3>
<p>While biomaRt can be used for many purposes, we are using it here as an easy way to get information about genes. I want to get the following information back from biomart:</p>
<ul>
<li>Ensembl Gene ID</li>
<li>HUGO Gene Symbol</li>
<li>Gene Description</li>
<li>Number of transcripts</li>
<li>chromosome</li>
<li>strand</li>
<li>GC %</li>
<li>Gene type</li>
<li>Status (novel or known)</li>
<li>phenotype description</li>
</ul>
<p>Again, we&apos;ll simply use the code below.  The details can be sought from the documentation.</p>
<pre><code class="lang-r">genes = getBM(mart=ensembl,attributes=c(<span class="hljs-string">&quot;ensembl_gene_id&quot;</span>,
                                         <span class="hljs-string">&quot;description&quot;</span>,
                                         <span class="hljs-string">&quot;chromosome_name&quot;</span>,
                                         <span class="hljs-string">&quot;strand&quot;</span>,
                                         <span class="hljs-string">&quot;percentage_gc_content&quot;</span>,
                                         <span class="hljs-string">&quot;transcript_count&quot;</span>,
                                         <span class="hljs-string">&quot;gene_biotype&quot;</span>,
                                         <span class="hljs-string">&quot;status&quot;</span>,
                                         <span class="hljs-string">&quot;hgnc_symbol&quot;</span>,
                                         <span class="hljs-string">&quot;phenotype_description&quot;</span>))
</code></pre>
<ul>
<li>Exercise: Investigate the structure of the <code>genes</code> object using functions such as <code>class</code>, <code>dim</code>, <code>colnames</code>, <code>summary</code>, etc.</li>
<li><p>Exercise: What is the range of the <code>percentage_gc_content</code>? How could you visualize this range of values effectively?</p>
</li>
<li><p>Exercise: What are the possible categories for the <code>gene_biotype</code> column?  How many genes fall into each category?</p>
</li>
<li><p>Exercise: Filter the <code>genes</code> data to include only those on the positive strand.</p>
</li>
<li><p>Exercise: Use <code>ggplot2</code> to make a boxplot of GC content for each different type of <code>gene_biotype</code>.</p>
</li>
</ul>
<h2 id="behavioral-risk-factor-surveillance-system">Behavioral Risk Factor Surveillance System</h2>
<p>You have been given a dataset that represents basic measurements of people over time.  Explore the data interactively to learn about trends or other features of interest in the data.  </p>
<p>To load the data:</p>
<pre><code class="lang-r">brfss = read.csv(<span class="hljs-string">&quot;http://watson.nci.nih.gov/~sdavis/tutorials/IntroToR/BRFSS-subset.csv&quot;</span>)
</code></pre>
<ul>
<li>Exercise: Explore the data in any way that you like, including plots, summaries, and data manipulations.  </li>
<li>Exercise, create a function that takes a vector of weights (in kg) and heights (in cm) and returns the Body Mass Index (BMI). </li>
</ul>
<p><a href="http://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html#Interpreted" target="_blank">http://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html#Interpreted</a></p>
<h1 id="session-info">Session Info</h1>
<pre><code class="lang-r">sessionInfo()
</code></pre>
<pre><code>## R version 3.2.1 (2015-06-18)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: OS X 10.10 (Yosemite)
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats4    parallel  stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] biomaRt_2.23.5           randomForest_4.6-10     
##  [3] gplots_2.16.0            ShortRead_1.25.8        
##  [5] GenomicAlignments_1.3.28 Rsamtools_1.19.35       
##  [7] GenomicRanges_1.20.3     GenomeInfoDb_1.3.13     
##  [9] Biostrings_2.35.11       XVector_0.7.4           
## [11] IRanges_2.2.1            S4Vectors_0.6.0         
## [13] BiocParallel_1.1.13      BiocGenerics_0.14.0     
## [15] nycflights13_0.1         ggplot2_1.0.1           
## [17] BiocStyle_1.5.3          knitr_1.8               
## [19] Rgitbook_0.9            
## 
## loaded via a namespace (and not attached):
##  [1] gtools_3.4.1         reshape2_1.4         knitcitations_1.0.6 
##  [4] lattice_0.20-31      colorspace_1.2-4     base64enc_0.1-2     
##  [7] XML_3.98-1.1         DBI_0.3.1            RColorBrewer_1.0-5  
## [10] foreach_1.4.2        plyr_1.8.1           stringr_0.6.2       
## [13] zlibbioc_1.13.1      munsell_0.4.2        gtable_0.1.2        
## [16] hwriter_1.3.2        caTools_1.17.1       codetools_0.2-11    
## [19] memoise_0.2.1        evaluate_0.5.5       labeling_0.3        
## [22] latticeExtra_0.6-26  Biobase_2.27.1       AnnotationDbi_1.30.1
## [25] proto_0.3-10         Rcpp_0.11.6          KernSmooth_2.23-14  
## [28] scales_0.2.4         checkmate_1.5.0      formatR_1.0         
## [31] gdata_2.13.3         sendmailR_1.2-1      brew_1.0-6          
## [34] BatchJobs_1.5        fail_1.2             digest_0.6.8        
## [37] BBmisc_1.8           RJSONIO_1.3-0        grid_3.2.1          
## [40] bibtex_0.4.0         tools_3.2.1          bitops_1.0-6        
## [43] RCurl_1.95-4.3       RSQLite_1.0.0        RefManageR_0.8.63   
## [46] MASS_7.3-40          lubridate_1.3.3      httr_0.6.1          
## [49] iterators_1.0.7
</code></pre>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../exercises/index.html" class="navigation navigation-prev " aria-label="Previous page: Exercises and Workflows"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../bio1/index.html" class="navigation navigation-next " aria-label="Next page: Biological Applications"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.5-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"ga":{"token":"UA-2851481-1","configuration":"auto"}};
    gitbook.start(config);
});
</script>

        <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-2851481-1', 'auto');ga('send', 'pageview');</script>
    </body>
    
</html>
