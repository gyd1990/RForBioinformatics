<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>ggplot2 | R for Bioinformatics</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.1.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    

        
    
    
    <link rel="next" href="../exercises/index.html" />
    
    
    <link rel="prev" href="../graphics/index.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="4.1" data-basepath=".." data-revision="Mon Jul 06 2015 17:51:11 GMT-0400 (EDT)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="section1/index.html">
            
                
                    <a href="../section1/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Overview of R
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="section2/index.html">
            
                
                    <a href="../section2/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Getting Started with R
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="section2/Installation.html">
            
                
                    <a href="../section2/Installation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Installation
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="section2/InteractingWithR.html">
            
                
                    <a href="../section2/InteractingWithR.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Interacting with the R command line
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="section3/index.html">
            
                
                    <a href="../section3/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Data Types
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="section3/vectors.html">
            
                
                    <a href="../section3/vectors.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Vectors
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="graphics/index.html">
            
                
                    <a href="../graphics/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Graphics
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="4.1" data-path="graphics/ggplot2.html">
            
                
                    <a href="../graphics/ggplot2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        ggplot2
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="exercises/index.html">
            
                
                    <a href="../exercises/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Exercises and Workflows
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="exercises/Data-exercises.html">
            
                
                    <a href="../exercises/Data-exercises.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Data exploration exercises
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="bio1/index.html">
            
                
                    <a href="../bio1/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Biological Applications
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="bio1/FASTQ.html">
            
                
                    <a href="../bio1/FASTQ.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Working with FASTQ files
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="GLOSSARY.html">
            
                
                    <a href="../GLOSSARY.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Glossary
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <a href="../GLOSSARY.html" class="btn pull-left" aria-label="Glossary"><i class="fa fa-sort-alpha-asc"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >R for Bioinformatics</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <hr>
<p>author: Sean Davis
title: Introduction to the Grammar of Graphics, ggplot2
output:
  BiocStyle::html_document:</p>
<pre><code>toc: true
</code></pre><hr>
<!--
%% \VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{02 ggplot2 Introduction}
-->
<h1 id="introduction">Introduction</h1>
<p>The <code>CRANpkg(&apos;ggplot2&apos;)</code> package is a relatively novel approach to generating highly informative publication-quality graphics. The &quot;gg&quot; stands for &quot;Grammar of Graphics&quot;. In short, instead of thinking about a single function that produces a plot, <code>CRANpkg(&apos;ggplot2&apos;)</code> uses a &quot;grammar&quot; approach, akin to building more and more complex sentences to layer on more information or nuance. </p>
<h1 id="data-model">Data Model</h1>
<p>The <code>CRANpkg(&apos;ggplot2&apos;)</code> package assumes that data are in the form of a data.frame. In some cases, the data will need to be manipulated into a form that matches assumptions that <code>CRANpkg(&apos;ggplot2&apos;)</code> uses.  In particular, if one has a <em>matrix</em> of numbers associated with different subjects (samples, people, etc.), the data will usually need to be transformed into a &quot;long&quot; data frame. </p>
<h1 id="getting-started">Getting started</h1>
<p>To use the <code>CRANpkg(&apos;ggplot2&apos;)</code> package, it must be installed and loaded. Assuming that installation has been done already, we can load the package directly:</p>
<pre><code class="lang-r"><span class="hljs-keyword">library</span>(ggplot2)
</code></pre>
<h1 id="playing-with-ggplot2">Playing with ggplot2</h1>
<h2 id="mtcars-data">mtcars data</h2>
<p>We are going to use the mtcars dataset, included with R, to experiment with <code>CRANpkg(&apos;ggplot2&apos;)</code>.  </p>
<pre><code class="lang-r">data(mtcars)
</code></pre>
<ul>
<li>Exercise: Explore the <code>mtcars</code> dataset using <code>View</code>, <code>summary</code>, <code>dim</code>, <code>class</code>, etc.</li>
</ul>
<p>We can also take a quick look at the relationships between the variables using the <code>pairs</code> plotting function.</p>
<pre><code class="lang-r">pairs(mtcars)
</code></pre>
<p>That is a useful view of the data. We want to use <code>CRANpkg(&apos;ggplot2&apos;)</code> to make an informative plot, so let&apos;s approach this in a piecewise fashion.  We first need to decide what type of plot to produce and what our basic variables will be.  In this case, we have a number of choices.  </p>
<pre><code class="lang-r">ggplot(mtcars,aes(x=disp,y=hp))
</code></pre>
<p>First, a little explanation is necessary.  The <code>ggplot</code> function takes as its first argument a <code>data.frame</code>.  The second argument is the &quot;aesthetic&quot;, <code>aes</code>.  The <code>x</code> and <code>y</code> take column names from the <code>mtcars</code> <code>data.frame</code> and will form the basis of our scatter plot. </p>
<p>But why did we get that &quot;Error: No layers in plot&quot;? Remember that <em>ggplot2</em> is a &quot;grammar of graphics&quot;. We supplied a subject, but no verb (called a <em>layer</em> by ggplot2). So, to generate a plot, we need to supply a verb.  There are many possibilities. Each &quot;verb&quot; or <em>layer</em> typically starts with &quot;geom&quot; and then a descriptor. An example is necessary.</p>
<pre><code class="lang-r">ggplot(mtcars,aes(x=disp,y=hp)) + geom_point()
</code></pre>
<p><img src="figure/ggplotS2-1.png" alt="plot of chunk ggplotS2"> </p>
<p>We finally produced a plot. The power of <em>ggplot2</em>, though, is the ability to make very rich plots by adding &quot;grammar&quot; to the &quot;plot sentence&quot;. We have a number of other variables in our <code>mtcars</code> <code>data.frame</code>. How can we add another value to a two-dimensional plot?</p>
<pre><code class="lang-r">ggplot(mtcars,aes(x=disp,y=hp,color=cyl)) + geom_point()
</code></pre>
<p><img src="figure/ggplotS3-1.png" alt="plot of chunk ggplotS3"> </p>
<p>The color of the points is a based on the numeric variable <code>wt</code>, the weight of the car. Can we do more? We can change the size of the points, also.</p>
<pre><code class="lang-r">ggplot(mtcars,aes(x=disp,y=hp,color=wt,size=mpg)) + geom_point()
</code></pre>
<p><img src="figure/ggplotS4-1.png" alt="plot of chunk ggplotS4"> </p>
<p>So, on our 2D plot, we are now plotting four variables.  Can we do more? We can manipulate the shape of the points in addition to the color and the size.</p>
<pre><code class="lang-r">ggplot(mtcars,aes(x=disp,y=hp)) + geom_point(aes(size=mpg,color=wt,shape=cyl))
</code></pre>
<p>Why did we get that error? Ggplot2 is trying to be helpful by telling us that a &quot;continuous varialbe cannot be mapped to &apos;shape&apos;&quot;. Well, in our <code>mtcars</code> <code>data.frame</code>, we can look at <code>cyl</code> in detail.</p>
<pre><code class="lang-r">class(mtcars$cyl)
</code></pre>
<pre><code>## [1] &quot;numeric&quot;
</code></pre><pre><code class="lang-r">summary(mtcars$cyl)
</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   4.000   4.000   6.000   6.188   8.000   8.000
</code></pre><pre><code class="lang-r">table(mtcars$cyl)
</code></pre>
<pre><code>## 
##  4  6  8 
## 11  7 14
</code></pre><p>The <code>cyl</code> variable is &quot;kinda&quot; continuous in that it is numeric, but it could also be thought of as a &quot;category&quot; of engines. R has a specific data type for &quot;category&quot; data, called a <em>factor</em>. We can easily convert the <code>cyl</code> column to a factor like so:</p>
<pre><code class="lang-r">mtcars$cyl = as.factor(mtcars$cyl)
</code></pre>
<p>Now, we can go ahead with our previous approach to make a 2-dimensional plot that displays the relationships between <em>five</em> variables.</p>
<pre><code class="lang-r">ggplot(mtcars,aes(x=disp,y=hp)) + geom_point(aes(size=mpg,color=wt,shape=cyl))
</code></pre>
<p><img src="figure/ggplotS6-1.png" alt="plot of chunk ggplotS6"> </p>
<h2 id="nyc-flight-data">NYC Flight data</h2>
<p>I leave this section open-ended for you to explore further options with the <em>ggplot2</em> package.  The data represent the on-time data for all flights that departed New York City in 2013.</p>
<pre><code class="lang-r"><span class="hljs-keyword">library</span>(nycflights13)
head(flights)
</code></pre>
<pre><code>##   year month day dep_time dep_delay arr_time arr_delay carrier tailnum
## 1 2013     1   1      517         2      830        11      UA  N14228
## 2 2013     1   1      533         4      850        20      UA  N24211
## 3 2013     1   1      542         2      923        33      AA  N619AA
## 4 2013     1   1      544        -1     1004       -18      B6  N804JB
## 5 2013     1   1      554        -6      812       -25      DL  N668DN
## 6 2013     1   1      554        -4      740        12      UA  N39463
##   flight origin dest air_time distance hour minute
## 1   1545    EWR  IAH      227     1400    5     17
## 2   1714    LGA  IAH      227     1416    5     33
## 3   1141    JFK  MIA      160     1089    5     42
## 4    725    JFK  BQN      183     1576    5     44
## 5    461    LGA  ATL      116      762    5     54
## 6   1696    EWR  ORD      150      719    5     54
</code></pre><p>Feel free to explore. Consider using other &quot;geoms&quot; during your exploration.</p>
<h1 id="session-info">Session Info</h1>
<pre><code class="lang-r">sessionInfo()
</code></pre>
<pre><code>## R version 3.2.1 (2015-06-18)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: OS X 10.10 (Yosemite)
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] nycflights13_0.1 ggplot2_1.0.1    BiocStyle_1.5.3  knitr_1.8       
## [5] Rgitbook_0.9    
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.11.6         knitcitations_1.0.6 MASS_7.3-40        
##  [4] munsell_0.4.2       colorspace_1.2-4    bibtex_0.4.0       
##  [7] stringr_0.6.2       httr_0.6.1          plyr_1.8.1         
## [10] tools_3.2.1         grid_3.2.1          gtable_0.1.2       
## [13] digest_0.6.8        RJSONIO_1.3-0       RefManageR_0.8.63  
## [16] reshape2_1.4        formatR_1.0         codetools_0.2-11   
## [19] RCurl_1.95-4.3      memoise_0.2.1       evaluate_0.5.5     
## [22] labeling_0.3        scales_0.2.4        XML_3.98-1.1       
## [25] lubridate_1.3.3     proto_0.3-10
</code></pre>  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2851481-1']);
    _gaq.push(['_trackPageview']);

    (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>


                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../graphics/index.html" class="navigation navigation-prev " aria-label="Previous page: Graphics"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../exercises/index.html" class="navigation navigation-next " aria-label="Next page: Exercises and Workflows"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.5-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"ga":{"token":"UA-2851481-1","configuration":"auto"}};
    gitbook.start(config);
});
</script>

        <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-2851481-1', 'auto');ga('send', 'pageview');</script>
    </body>
    
</html>
